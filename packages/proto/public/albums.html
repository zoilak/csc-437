<!DOCTYPE html>
<html lang="en">
<head>
  <title>Album Review</title>
  <link rel="stylesheet" href="css/tokens.css">
  <link rel="stylesheet" href="css/style.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Bungee+Shade&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Noticia+Text:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
</head>
<body>
  <!-- <h1 align="center">Welcome to TrackBoxd
    <svg class="icon">
      <use href="/icons/icons.svg#album-cover" />
    </svg>
  </h1> -->
  <script type="module">
  import { define } from "@calpoly/mustang";
  import { TrackboxdHeader } from "./src/header.ts";

  define({
    "trackboxd-header": TrackboxdHeader
  });
</script>
<trackboxd-header></trackboxd-header>

  <ul class="navbar">
    <li><a href="index.html">TrackBoxd</a></li>
    <li><a href="user.html">User</a></li>
    <li><a href="community.html">Community</a></li>
    <li><a href="settings.html">Settings</a></li>
    <li><a href="signup.html">Sign Up</a></li>
  </ul>

  <!-- <h1 alt="albumTitle"></h1>  -->
  <div class="album-container">
  <h1 id="albumTitle"></h1>
  <img id="albumCover" src="" alt="albumCover" width="300" height="300">
  </div>
  <div class="album-info">
  <p><strong>Album:</strong> <span id="albumTitle"></span></p>
  <p><strong>Artist:</strong> <span id="artistName"></span></p>
  <p><strong>Total Tracks:</strong> <span id="trackCount"></span></p>
  <p><strong>Release Date:</strong> <span id="releaseDate"></span></p>
  </div>

  <script>
    // Get album info from URL
    const params = new URLSearchParams(window.location.search);
    const albumId = params.get('id');
    const albumTitle = params.get('title');
    const albumCover = params.get('cover');
    const artistName = params.get('artist');
    const trackCount = params.get('tracks');
    const releaseDate = params.get('release');

    // Display album info
    //document.getElementById('albumTitle').textContent = albumTitle;
    document.getElementById('albumCover').src = albumCover;
    document.getElementById('albumCover').alt = albumTitle;
    document.getElementById('artistName').textContent = artistName;
    document.getElementById('trackCount').textContent = trackCount;
    document.getElementById('releaseDate').textContent = releaseDate;
    // Review handling (using localStorage for demo)
    const reviewsDiv = document.getElementById('reviews');
    const reviewsKey = `reviews_${albumId}`;
    const reviews = JSON.parse(localStorage.getItem(reviewsKey)) || [];

    function renderReviews() {
      reviewsDiv.innerHTML = reviews.length
        ? reviews.map(r => `
            <div class="review">
              <strong>${r.name}</strong>: ${r.comment}
            </div>
          `).join('')
        : "<p>No reviews yet. Be the first to add one!</p>";
    }

    renderReviews();

    // Handle form submission
    const form = document.getElementById('reviewForm');
    form.addEventListener('submit', (e) => {
      e.preventDefault();
      const name = document.getElementById('username').value;
      const comment = document.getElementById('comment').value;
      reviews.push({ name, comment });
      localStorage.setItem(reviewsKey, JSON.stringify(reviews));
      form.reset();
      renderReviews();
    });
  </script>
  <script>
    const darkModeToggle = document.querySelector('input[type="checkbox"]');

    if (localStorage.getItem('darkMode') === 'enabled') {
      document.body.classList.add('dark-mode');
      darkModeToggle.checked = true;
    }

    darkModeToggle.addEventListener('change', function () {
      if (this.checked) {
        document.body.classList.add('dark-mode');
        localStorage.setItem('darkMode', 'enabled');
      } else {
        document.body.classList.remove('dark-mode');
        localStorage.setItem('darkMode', 'disabled');
      }
    });
  </script>
</body>
</html>
